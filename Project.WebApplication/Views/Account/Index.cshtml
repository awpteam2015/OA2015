@using System.Web.UI.WebControls
@using Project.Model.PermissionManager
@using Project.Service.PermissionManager.DTO
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    @Html.Partial("_Head")
    <script src="~/Scripts/Account/Index.js"></script>
</head>
<body class="easyui-layout">
    <div data-options="region:'north',split:true" style="overflow: hidden; height: 35px; background: #E0ECFF repeat-x center 50%;color: #fff;">
        <div style="background: #E0ECFF; height: 100%;">
            <div style="float: left; width: 40%;">
                <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-man',plain:true" style="float: left;">双易家居</a>
                <div class="datagrid-btn-separator" style="height: 15px; margin: 7px 2px 0;"></div>
                @*<a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-user',plain:true" style="float: left;">@ViewBag.User.UserName </a>*@
            </div>
            <div style="float: right; width: 58%; padding-right:5px;">
                <div class="datagrid-btn-separator" style="height: 15px; margin: 7px 2px 0; float: right;"></div>
                <a href="javascript:void(0)" id="btnLogoff" class="easyui-linkbutton" data-options="iconCls:'icon-lock_go',plain:true" style="float: right;">注销</a>
                <div class="datagrid-btn-separator" style="height: 15px; margin: 7px 2px 0; float: right;"></div>
            </div>
            <div style="clear: both;">
            </div>
        </div>
    </div>
    <div data-options="region:'west',split:true,title:'导航菜单',icon:'icon-redo'" style="width: 200px;">
        <div id="menu" class="easyui-accordion" data-options="border:false,fit:true">

            @foreach (MenuDTO p in ViewBag.ModuleList)
            {
                <div title="@p.Name" data-options="iconCls:'icon-asterisk_yellow'">
                    <ul class='menulist'>
                        @foreach (var child in p.MenuDTOList)
                        {
                            <li><a target='mainFrame' href='javascript:void(0)' lang='@child.Url'>@child.Name</a></li>
                        }
                    </ul>
                </div>
            }
            <div title="Test2" data-options="iconCls:'icon-workflow'">
                <ul class='menulist'>
                    <li><a target='mainFrame' href='javascript:void(0)' lang='/Home/WorkflowMenu'>流程发起</a></li>
                </ul>
            </div>
            @*<div title="个人事务" data-options="iconCls:'icon-imailManage'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang='/Permission/UserList'>用户列表</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang='/Photography/Index'>摄影棚拍照</a></li>
                    </ul>
                </div>
                <div title="综合行政" data-options="iconCls:'icon-document'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>
                <div title="信息管理" data-options="iconCls:'icon-task'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>
                <div title="知识管理" data-options="iconCls:'icon-docMag'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>
                <div title="固定资产管理" data-options="iconCls:'icon-imailManage'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>
                <div title="财务管理" data-options="iconCls:'icon-cultureView'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>
                <div title="其它系统" data-options="iconCls:'icon-cultureView'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>论坛</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>HH—OMS系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>HH—EC系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>HH—官网系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>TAO—OMS系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>TAO—EC系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>TAO—官网系统</a></li>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>人事系统</a></li>
                    </ul>
                </div>
                <div title="常用工具" data-options="iconCls:'icon-cultureView'">
                    <ul class='menulist'>
                        <li><a target='mainFrame' href='javascript:void(0)' lang=''>流程发起</a></li>
                    </ul>
                </div>*@
        </div>
    </div>
    <div data-options="region:'south',border:false" style="height: 20px; background: #D2E0F2;">
        <div style="text-align: center; font-weight: bold">
            人事管理系统 1.0
        </div>
    </div>
    <div data-options="region:'center'" style="background: #eee; overflow: hidden;">
        <div id="tabsDefault" class="easyui-tabs" data-options="fit:true,border:false" style="overflow:hidden;">
            <div title="主页" style="padding: 0px; font-size: large;overflow:hidden;" id="home" iconcls="icon-house">
                <iframe name="mainFrame" scrolling="no" frameborder="0" src="" style="width:100%;height:100%;"></iframe>
            </div>
        </div>
    </div>

    @*<div id="updatePwdWin" class="easyui-dialog" title="修改密码" style="width:300px;height:200px; padding:10px 10px; background-color:#fff;"
             data-options="iconCls:'icon-save',modal:true,closed:true,buttons:[{
                    text:'确认修改',iconCls:'icon-ok',handler: $.Index.updatePwdHandler
                },{
                    text:'关闭',iconCls:'icon-cancel',handler: $.Index.closeUpdatePwdWin
                }]">
            <form id="upPwdForm" method="post">
                <table>
                    <tr>
                        <td>新密码：</td>
                        <td><input id="pw1" type="password" name="newPwd" style="width:150px;" /></td>
                    </tr>
                    <tr>
                        <td>确认新密码：</td>
                        <td><input id="pw2" type="password" name="newPwdConfirm" style="width:150px;" /></td>
                    </tr>
                </table>
            </form>
        </div>*@
    <div id="tabs_menu" class="easyui-menu" style="width: 150px;">
        <div id="mm-tabclose" name="1" data-options="iconCls:'icon-cancel'">关闭</div>
        <div id="mm-tabcloseall" name="2">全部关闭</div>
        <div id="mm-tabcloseother" name="3">除此之外全部关闭</div>
        <div class="menu-sep"></div>
        <div id="mm-tabcloseright" name="4">当前页右侧全部关闭</div>
        <div id="mm-tabcloseleft" name="5">当前页左侧全部关闭</div>
    </div>
    <script type="text/javascript">
        $('#tabsDefault').tabs({
            onContextMenu: function (e, title, index) {
                e.preventDefault();
                if (index > 0) {
                    $('#tabs_menu').menu('show', {
                        left: e.pageX,
                        top: e.pageY
                    }).data("tabTitle", title);
                }
            }
        });
        //右键菜单click
        $("#tabs_menu").menu({
            onClick: function (item) {
                closeTab(this, item.name);
            }
        });


        //删除Tabs
        function closeTab(menu, type) {
            var allTabs = $("#tabsDefault").tabs('tabs');
            var allTabtitle = [];
            $.each(allTabs, function (i, n) {
                var opt = $(n).panel('options');
                if (opt.closable)
                    allTabtitle.push(opt.title);
            });
            var curTabTitle = $(menu).data("tabTitle");
            var curTabIndex = $("#tabsDefault").tabs("getTabIndex", $("#tabsDefault").tabs("getTab", curTabTitle));
            var i;
            switch (type) {
                case "1"://关闭当前
                    $("#tabsDefault").tabs("close", curTabTitle);
                    return false;
                    break;
                case "2"://全部关闭
                    for (i = 0; i < allTabtitle.length; i++) {
                        $('#tabsDefault').tabs('close', allTabtitle[i]);
                    }
                    break;
                case "3"://除此之外全部关闭
                    for (i = 0; i < allTabtitle.length; i++) {
                        if (curTabTitle !== allTabtitle[i])
                            $('#tabsDefault').tabs('close', allTabtitle[i]);
                    }
                    $('#tabsDefault').tabs('select', curTabTitle);
                    break;
                case "4"://当前侧面右边
                    for (i = curTabIndex; i < allTabtitle.length; i++) {
                        $('#tabsDefault').tabs('close', allTabtitle[i]);
                    }
                    $('#tabsDefault').tabs('select', curTabTitle);
                    break;
                case "5": //当前侧面左边
                    for (i = 0; i < curTabIndex - 1; i++) {
                        $('#tabsDefault').tabs('close', allTabtitle[i]);
                    }
                    $('#tabsDefault').tabs('select', curTabTitle);
                    break;

            }

        };
    </script>
</body>
</html>
